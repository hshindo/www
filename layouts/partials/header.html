{{ define "menu-item" }}
<li>
    <a class="black-text" href="{{ .URL | relLangURL }}">{{ .Name }}</a>
</li>
{{ end }}

{{ define "nav-menu" }}
    {{ range $index, $menu := .Site.Menus.main }}
        {{ if $menu.HasChildren }}
            <ul id="{{ $.Scratch.Get `id` }}-{{ $index }}" class="dropdown-content">
                {{ range $menu.Children }}
                    {{ block "menu-item" . }}{{ end }}
                {{ end }}
            </ul>
            <li>
                <a class="dropdown-button black-text" href="#!" data-activates="{{ $.Scratch.Get "id" }}-{{ $index }}">{{ $menu.Name }}
                    <i class="material-icons right">arrow_drop_down</i>
                </a>
            </li>
        {{ else }}
            {{ block "menu-item" $menu }}{{ end }}
        {{ end }}
    {{ end }}

    <!-- Language Switcher -->
    <ul id="{{ $.Scratch.Get `id` }}-language-switcher" class="dropdown-content">
        {{ range .AllTranslations }}
            <li>
                <a class="black-text" href="{{ .URL }}">{{ .Language.LanguageName }}</a>
            </li>
        {{ end }}
    </ul>
    <li>
        <a class="dropdown-button black-text" href="#!" data-activates="{{ $.Scratch.Get `id` }}-language-switcher">Language
            <i class="material-icons right">arrow_drop_down</i>
        </a>
    </li>
{{ end }}

<div class="navbar-fixed">
    <nav class="white" role="navigation">
        <div class="row">
            <div class="col s12 l10 offset-l1">
                <!-- Hamburger menu -->
                <a href="#" data-activates="nav-mobile" class="button-collapse black-text">
                    <i class="material-icons">menu</i>
                </a>

                <!-- Brand -->
                <a href="{{ .Site.BaseURL | relLangURL }}" class="brand-logo grey-text text-darken-3">{{ .Site.Title }}</a>

                <!-- Navigation container -->
                <div class="nav-wrapper">

                    <!-- Menu -->
                    <ul class="right hide-on-med-and-down">
                        {{ $.Scratch.Set "id" "dropdown-header-desktop" }}
                        {{ block "nav-menu" . }}{{ end }}
                        {{ $.Scratch.Delete "id" }}
                    </ul>

                </div>
            </div>
        </div>
    </nav>
</div>

<!--
    Mobile sidenav

    when using fixed navbar, mobile menu should be outside of the `div.navbar-fixed`.
    otherwise, mobile drawer is covered under the modal overlay and
    users can't intaract with the drawer.

    see: https://github.com/Dogfalo/materialize/issues/1664#issuecomment-285730639
-->
<ul id="nav-mobile" class="side-nav">
    {{ $.Scratch.Set "id" "dropdown-header-mobile" }}
    {{ block "nav-menu" . }}{{ end }}
    {{ $.Scratch.Delete "id" }}
</ul>